(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[376,621],{530:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>k});var r=t(5155),a=t(2115),c=t(63),l=t(6900),o=t(3147),i=t(1171),d=t(8902),n=t(7621),m=t(5626),x=t(952);let h=(0,t(5105).A)("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);var g=t(3873),u=t(6617),p=t(7125),b=t(6191),y=t(7919),f=t(2619),j=t.n(f),N=t(5239),v=t(1165),w=t(5536);function k(){let e=(0,c.useParams)(),s=(0,c.useRouter)(),t=e.slug,{addItem:f}=(0,v._)(),k=(0,w.h)(),[A,E]=(0,a.useState)(null),[P,S]=(0,a.useState)([]),[C,B]=(0,a.useState)(!0),[T,I]=(0,a.useState)(1),[_,M]=(0,a.useState)(!1),[D,F]=(0,a.useState)(!1),[q,z]=(0,a.useState)("");(0,a.useEffect)(()=>{let e=async()=>{try{let e=await n.ZN.getBySlug(t);if(E(e),e.categoryId){let s=(await n.ZN.getByCategory(e.categoryId)).filter(e=>e.slug!==t).slice(0,4);S(s)}}catch(e){console.error("Error fetching product:",e),s.push("/productos")}finally{B(!1)}};t&&e()},[t,s]);let L=e=>new Intl.NumberFormat("es-CL",{style:"currency",currency:"CLP",minimumFractionDigits:0}).format(e);if(C)return(0,r.jsx)(l.U,{children:(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto mb-4"}),(0,r.jsx)(d.E,{children:"Cargando producto..."})]})})});if(!A)return(0,r.jsx)(l.U,{children:(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(i.D,{level:2,children:"Producto no encontrado"}),(0,r.jsx)(j(),{href:"/productos",children:(0,r.jsx)(y.$,{className:"mt-4",children:"Volver a Productos"})})]})})});let U=A.price*T+(D&&A.canBeEmbroidered&&A.embroideryPrice?A.embroideryPrice*T:0);return(0,r.jsx)(l.U,{children:(0,r.jsx)("div",{className:"bg-gradient-to-b from-gray-50 to-white py-6 sm:py-8",children:(0,r.jsxs)("div",{className:"container mx-auto px-4 sm:px-6",children:[(0,r.jsx)("div",{className:"mb-6",children:(0,r.jsx)(j(),{href:"/productos",children:(0,r.jsxs)(y.$,{variant:"ghost",size:"sm",className:"mb-4",children:[(0,r.jsx)(m.A,{className:"w-4 h-4 mr-2"}),"Volver a Productos"]})})}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 sm:gap-12 mb-12",children:[(0,r.jsxs)("div",{className:"relative aspect-square bg-gradient-to-br from-gray-100 to-gray-200 rounded-2xl overflow-hidden",children:[A.image?(0,r.jsx)(N.default,{src:A.image,alt:A.name,fill:!0,className:"object-cover",priority:!0}):(0,r.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,r.jsx)(x.A,{className:"w-24 h-24 text-gray-400"})}),A.isFeatured&&(0,r.jsx)("div",{className:"absolute top-4 right-4 bg-primary-600 text-white text-sm font-semibold px-3 py-1.5 rounded-full",children:"Destacado"}),A.canBeEmbroidered&&(0,r.jsx)("div",{className:"absolute top-4 left-4 bg-accent-600 text-white text-sm font-semibold px-3 py-1.5 rounded-full",children:"✨ Bordado disponible"})]}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[A.category&&(0,r.jsx)(j(),{href:"/categorias/".concat(A.category.slug),children:(0,r.jsxs)("span",{className:"inline-flex items-center gap-2 text-sm text-primary-600 hover:text-primary-700 mb-3",children:[(0,r.jsx)(h,{className:"w-4 h-4"}),A.category.name]})}),(0,r.jsx)(i.D,{level:1,className:"mb-4",children:A.name}),(0,r.jsxs)("div",{className:"text-3xl sm:text-4xl font-bold text-primary-600 mb-6",children:[L(A.price),D&&A.canBeEmbroidered&&A.embroideryPrice&&(0,r.jsxs)("span",{className:"text-lg text-gray-600 ml-2",children:["+ ",L(A.embroideryPrice)," (bordado)"]})]})]}),A.description&&(0,r.jsxs)("div",{children:[(0,r.jsx)(i.D,{level:3,className:"text-lg mb-3",children:"Descripci\xf3n"}),(0,r.jsx)(d.E,{className:"text-gray-700 leading-relaxed",children:A.description})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[A.size&&(0,r.jsxs)("div",{className:"bg-gray-50 rounded-xl p-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 text-gray-600 mb-1",children:[(0,r.jsx)(g.A,{className:"w-4 h-4"}),(0,r.jsx)("span",{className:"text-xs font-medium",children:"Talla"})]}),(0,r.jsx)(d.E,{className:"text-sm font-semibold",children:A.size})]}),A.color&&(0,r.jsxs)("div",{className:"bg-gray-50 rounded-xl p-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 text-gray-600 mb-1",children:[(0,r.jsx)(h,{className:"w-4 h-4"}),(0,r.jsx)("span",{className:"text-xs font-medium",children:"Color"})]}),(0,r.jsx)(d.E,{className:"text-sm font-semibold",children:A.color})]}),(0,r.jsxs)("div",{className:"bg-gray-50 rounded-xl p-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 text-gray-600 mb-1",children:[(0,r.jsx)(u.A,{className:"w-4 h-4"}),(0,r.jsx)("span",{className:"text-xs font-medium",children:"Stock"})]}),(0,r.jsx)(d.E,{className:"text-sm font-semibold ".concat(A.stock>0?"text-green-600":"text-red-600"),children:A.stock>0?"".concat(A.stock," disponibles"):"Sin stock"})]})]}),A.canBeEmbroidered&&(0,r.jsxs)("div",{className:"bg-accent-50 border-2 border-accent-200 rounded-xl p-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,r.jsx)("input",{type:"checkbox",id:"embroider",checked:D,onChange:e=>F(e.target.checked),className:"w-5 h-5 text-accent-600 rounded focus:ring-accent-500"}),(0,r.jsxs)("label",{htmlFor:"embroider",className:"text-sm font-semibold text-accent-900",children:["Agregar bordado de nombre (+ ",L(A.embroideryPrice||0),")"]})]}),D&&(0,r.jsx)("input",{type:"text",placeholder:"Nombre para bordar",value:q,onChange:e=>z(e.target.value),className:"w-full px-4 py-2 border border-accent-300 rounded-lg focus:ring-2 focus:ring-accent-500 focus:border-transparent mt-2"})]}),(0,r.jsx)("div",{className:"pt-4 space-y-4",children:A.stock>0?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Cantidad:"}),(0,r.jsxs)("div",{className:"flex items-center gap-2 border border-gray-300 rounded-lg",children:[(0,r.jsx)("button",{onClick:()=>I(Math.max(1,T-1)),className:"p-2 hover:bg-gray-100 transition-colors",disabled:T<=1,children:(0,r.jsx)(p.A,{className:"w-4 h-4"})}),(0,r.jsx)("span",{className:"px-4 py-2 min-w-[3rem] text-center font-semibold",children:T}),(0,r.jsx)("button",{onClick:()=>I(Math.min(A.stock,T+1)),className:"p-2 hover:bg-gray-100 transition-colors",disabled:T>=A.stock,children:(0,r.jsx)(b.A,{className:"w-4 h-4"})})]})]}),(0,r.jsx)("div",{className:"bg-primary-50 border border-primary-200 rounded-xl p-4 mb-4",children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)(d.E,{className:"font-semibold",children:"Total:"}),(0,r.jsx)(d.E,{className:"text-xl font-bold text-primary-600",children:L(U)})]})}),(0,r.jsx)(y.$,{className:"w-full",onClick:()=>T>A.stock?void k.showWarning("Solo hay ".concat(A.stock," unidades disponibles")):D&&!q.trim()?void k.showWarning("Por favor, ingresa el nombre para bordar"):void(M(!0),f(A,T,!0,D,q||void 0),setTimeout(()=>{M(!1)},500)),disabled:_,children:_?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Agregando..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(x.A,{className:"w-5 h-5 mr-2"}),"Agregar al carrito"]})})]}):(0,r.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4",children:(0,r.jsx)(d.E,{className:"text-sm text-red-700 text-center",children:"Producto sin stock disponible"})})})]})]}),P.length>0&&(0,r.jsxs)("div",{className:"mt-16",children:[(0,r.jsx)(i.D,{level:2,className:"mb-6",children:"Productos Relacionados"}),(0,r.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6",children:P.map(e=>(0,r.jsx)(o.A,{product:e},e.id))})]})]})})})}},3147:(e,s,t)=>{"use strict";t.d(s,{A:()=>i});var r=t(5155),a=t(2619),c=t.n(a),l=t(3405),o=t(952);let i=e=>{let s,{product:t}=e;return(0,r.jsx)(c(),{href:"/productos/".concat(t.slug),children:(0,r.jsxs)(l.Z,{className:"group overflow-hidden h-full flex flex-col border-2 border-transparent hover:border-primary-200 hover:shadow-xl transition-all duration-300",children:[(0,r.jsxs)("div",{className:"relative aspect-square bg-gradient-to-br from-gray-100 to-gray-200 overflow-hidden rounded-t-xl",children:[t.image?(0,r.jsx)("img",{src:t.image,alt:t.name,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-500"}):(0,r.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,r.jsx)(o.A,{className:"w-10 h-10 sm:w-12 sm:h-12 text-gray-400"})}),t.isFeatured&&(0,r.jsx)("div",{className:"absolute top-2 right-2 bg-gradient-to-r from-primary-600 to-primary-700 text-white text-xs font-semibold px-2.5 py-1 rounded-full shadow-md",children:"⭐ Destacado"}),t.canBeEmbroidered&&(0,r.jsx)("div",{className:"absolute top-2 left-2 bg-gradient-to-r from-accent-500 to-accent-600 text-white text-xs font-semibold px-2.5 py-1 rounded-full shadow-md",children:"✨ Bordado"}),(0,r.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-black/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]}),(0,r.jsxs)("div",{className:"p-3 sm:p-4 flex flex-col flex-grow",children:[(0,r.jsx)("h3",{className:"font-semibold text-sm sm:text-base text-gray-900 mb-1 sm:mb-2 line-clamp-2 group-hover:text-primary-600 transition-colors",children:t.name}),t.description&&(0,r.jsx)("p",{className:"text-xs sm:text-sm text-gray-600 mb-2 sm:mb-3 line-clamp-2 flex-grow",children:t.description}),(0,r.jsxs)("div",{className:"flex items-center justify-between mt-auto pt-2 border-t border-gray-100",children:[(0,r.jsx)("span",{className:"text-base sm:text-lg font-bold text-primary-600",children:(s=t.price,new Intl.NumberFormat("es-CL",{style:"currency",currency:"CLP",minimumFractionDigits:0}).format(s))}),t.stock>0?(0,r.jsxs)("span",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded-full",children:[t.stock," disponibles"]}):(0,r.jsx)("span",{className:"text-xs text-red-600 bg-red-50 px-2 py-1 rounded-full font-medium",children:"Sin stock"})]})]})]})})}},3873:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(5105).A)("Shirt",[["path",{d:"M20.38 3.46 16 2a4 4 0 0 1-8 0L3.62 3.46a2 2 0 0 0-1.34 2.23l.58 3.47a1 1 0 0 0 .99.84H6v10c0 1.1.9 2 2 2h8a2 2 0 0 0 2-2V10h2.15a1 1 0 0 0 .99-.84l.58-3.47a2 2 0 0 0-1.34-2.23z",key:"1wgbhj"}]])},5626:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(5105).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},5650:(e,s,t)=>{Promise.resolve().then(t.bind(t,530))},6191:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(5105).A)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},6617:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(5105).A)("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]])},7125:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(5105).A)("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]])},7621:(e,s,t)=>{"use strict";t.d(s,{ZN:()=>l,Zx:()=>o,cN:()=>i,customersApi:()=>d});let r=t(5704).env.NEXT_PUBLIC_API_URL||"http://localhost:3004";class a{async request(e,s,t){let r="".concat(this.baseUrl).concat(e),a=localStorage.getItem("customer_token");try{let e=await fetch(r,{...s,headers:{"Content-Type":"application/json",...a&&{Authorization:"Bearer ".concat(a)},...t,...null==s?void 0:s.headers}});if(!e.ok){let s=await e.json().catch(()=>({message:"Error HTTP: ".concat(e.status," ").concat(e.statusText)})),t=s.message||s.error||"Error HTTP: ".concat(e.status);409===e.status?t=s.message||"Este email ya est\xe1 registrado. Por favor, inicia sesi\xf3n o usa otro email.":401===e.status?t=s.message||"Credenciales inv\xe1lidas. Verifica tu email y contrase\xf1a.":400===e.status?t=s.message||s.error||"Datos inv\xe1lidos. Por favor, verifica la informaci\xf3n ingresada.":404===e.status?t=s.message||"Recurso no encontrado.":e.status>=500&&(t="Error del servidor. Por favor, intenta m\xe1s tarde.");let r=Error(t);throw r.status=e.status,r.error=s,r}return e.json()}catch(e){if(e instanceof Error)throw e;throw Error("Error de red al conectar con el servidor")}}async get(e,s){return this.request(e,{method:"GET"},s)}async post(e,s,t){return this.request(e,{method:"POST",body:JSON.stringify(s)},t)}async patch(e,s){return this.request(e,{method:"PATCH",body:JSON.stringify(s)})}async delete(e){return this.request(e,{method:"DELETE"})}constructor(e){this.baseUrl=e}}let c=new a(r),l={getAll:()=>c.get("/products?isActive=true"),getFeatured:()=>c.get("/products/featured"),getById:e=>c.get("/products/".concat(e)),getBySlug:e=>c.get("/products/slug/".concat(e)),getByCategory:e=>c.get("/products?categoryId=".concat(e,"&isActive=true"))},o={getAll:()=>c.get("/categories"),getById:e=>c.get("/categories/".concat(e)),getBySlug:e=>c.get("/categories/slug/".concat(e))},i={create:e=>c.post("/orders",e),getMyOrders:()=>{let e=localStorage.getItem("customer_token");return c.get("/orders/my-orders",e?{Authorization:"Bearer ".concat(e)}:{})},getById:e=>c.get("/orders/".concat(e)),getShippingTypes:()=>c.get("/orders/shipping/types"),initiateWebpay:e=>c.post("/orders/".concat(e,"/webpay/init")),confirmWebpay:e=>c.post("/orders/webpay/confirm",{token:e})},d={register:e=>c.post("/customers/register",e),login:e=>c.post("/customers/login",e),getProfile:()=>{let e=localStorage.getItem("customer_token");return c.get("/customers/me",e?{Authorization:"Bearer ".concat(e)}:{})}}}},e=>{e.O(0,[134,76,690,441,255,358],()=>e(e.s=5650)),_N_E=e.O()}]);